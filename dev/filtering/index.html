<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Particle Filtering · AutomotiveInteraction.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AutomotiveInteraction.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../driving_simulation/">Driving Simulation</a></li><li class="is-active"><a class="tocitem" href>Particle Filtering</a></li><li><a class="tocitem" href="../">About</a></li><li><a class="tocitem" href="../roadway_building/">Roadway Building</a></li><li><a class="tocitem" href="../veh_track_reading/">Vehicle Track Reading</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Particle Filtering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Particle Filtering</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/master/docs/src/filtering.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Particle-Filtering-1"><a class="docs-heading-anchor" href="#Particle-Filtering-1">Particle Filtering</a><a class="docs-heading-anchor-permalink" href="#Particle-Filtering-1" title="Permalink"></a></h1><p>These functions are responsible for performing particle filtering for parameter estimation.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>c_idm_from_particle</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.hallucinate_a_step" href="#AutomotiveInteraction.hallucinate_a_step"><code>AutomotiveInteraction.hallucinate_a_step</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function hallucinate_a_step(scene_input,particle;car_id=-1)</code></pre><ul><li>Hallucinate one step starting from <code>scene_input</code> using parameters given by <code>particle</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">scene = f.traj[1]
particle = [29.,NaN,1.5,5.,0.35,0.1,NaN,1.0]
hallucinate_a_step(f,scene,particle,car_id=6)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/particle_filtering.jl#L30-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.weight_and_resample" href="#AutomotiveInteraction.weight_and_resample"><code>AutomotiveInteraction.weight_and_resample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function weight_and_resample(start_scene,true_nextpos,true_nextlane,p_mat;car_id=-1)</code></pre><ul><li>Hallucination from <code>start_scene</code> </li><li>Compare against ground truth at <code>true_nextpos</code>, <code>true_nextlane</code></li><li>Assign weights to particles</li><li>Perform resampling and return a new matrix of particles and associated weight vector</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia"># Test for one step on initial particle matrix
limits = [10. 40.;0.1 10.;0.5 5.;1. 10.;0. 1.;-1. 1.;0. 20.;0. 1.]
init_pmat = initial_pmat(limits=limits,num_particles=10,seed=4)
id = 6
scene = f.traj[1]
true_next_scene = deepcopy(f.traj[2])
true_nextpos = get_frenet_s(true_next_scene;car_id=id)
true_nextlane = get_lane_id(true_next_scene,id)
weight_and_resample(f,scene,true_nextpos,true_nextlane,init_pmat,car_id=id)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/particle_filtering.jl#L68-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.multistep_update" href="#AutomotiveInteraction.multistep_update"><code>AutomotiveInteraction.multistep_update</code></a> — <span class="docstring-category">Function</span></header><section><div><p>function multistep<em>update(f::FilteringEnvironment;car</em>id,start<em>frame,last</em>frame,num_p=500,seed=1)</p><ul><li>Run filtering over a trajectory by starting from a true scene</li><li>Repeatedly calls <code>weight_and_resample</code> on a demonstration trajectory</li></ul><p><strong>Caveats</strong></p><ul><li>Hard coded limits on initial particle distribution generation</li></ul><p><strong>Returns</strong></p><ul><li><code>final_p_mat</code>: Matrix with particles in separate columns. Mean of final particle set</li><li><code>iterwise_p_mat</code>: A list with the associated particle matrix at each iteration</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">final_p_mat,iterwise_p_mat = multistep_update(f,car_id=6,start_frame=1,last_frame=99)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/particle_filtering.jl#L135-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.obtain_driver_models" href="#AutomotiveInteraction.obtain_driver_models"><code>AutomotiveInteraction.obtain_driver_models</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function obtain_driver_models(f::FilteringEnvironment,veh_id_list,num_particles,start_frame,last_frame)</code></pre><p>Driver models for each vehicle in veh<em>id</em>list</p><p><strong>Arguments</strong></p><ul><li><code>veh_id_list</code>: List with vehicle ids</li><li><code>num_p</code>: Number of particles</li><li><code>ts</code>: Frame to start filtering from</li><li><code>te</code>: Frame to end hallucination at</li></ul><p><strong>Returns</strong></p><ul><li><code>models</code> Dict with veh id as key and IDM driver model as value</li><li><code>final_particles</code> Dict with veh id as key and avg particle over final particle set as value</li><li><code>mean_dist_mat</code>: Every elem is the mean dist of particle set at that iter (row) for that car (column)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia">veh_id_list = [6]
f = FilteringEnvironment()
new_models,final_particles,mean_dist_mat = obtain_driver_models(f,veh_id_list=veh_id_list,num_p=50,ts=1,te=5)
avg_over_cars = mean(mean_dist_mat,dims=2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/particle_filtering.jl#L187-L209">source</a></section></article><p>The following functions are helpers. They provide access to information about vehicle state, as well as help visualize filtering progress.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>get_frenet_s</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>get_veh_info</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>get_lane_id</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>get_lane_change_prob</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.initial_pmat" href="#AutomotiveInteraction.initial_pmat"><code>AutomotiveInteraction.initial_pmat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function initial_pmat(;limits,num_particles,seed)</code></pre><ul><li>Generate initial particle matrix with <code>num_particles</code> particles with every col being a diff particle</li><li>Range of values that parameters can take is specified in <code>limits</code>. Should be num_params rows x 2 cols</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">limits = [10. 40.;0.1 10.;0.5 5.;1. 10.;0. 1.;-1. 1.;-20. 20.;0. 1.]
initial_pmat(limits=limits,num_particles=10,seed=4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/utils.jl#L75-L85">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>pgfplots2gif</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="AutomotiveInteraction.plot_pairwise_particles" href="#AutomotiveInteraction.plot_pairwise_particles"><code>AutomotiveInteraction.plot_pairwise_particles</code></a> — <span class="docstring-category">Function</span></header><section><div><ul><li>We have a list with corresponding particle matrix at every iteration of filtering</li><li>We shall scatter two columns of said matrix</li><li>We shall make a video with said scatter at every timestep</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">seed = 2; num_p = 500
Random.seed!(seed)
final_p_mat,iterwise_p_mat = multistep_update(car_id=1,start_frame=2,last_frame=99,num_p=num_p);
plot_pairwise_particles(iterwise_p_mat,filename=&quot;test/media/seed2.gif&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sisl/AutomotiveInteraction.jl/blob/65582b2cbc34cf635728f81780a78a2bf99c2fd1/src/Filtering/utils.jl#L122-L134">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../driving_simulation/">« Driving Simulation</a><a class="docs-footer-nextpage" href="../">About »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 12 May 2020 01:59">Tuesday 12 May 2020</span>. Using Julia version 1.4.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
